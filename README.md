# Multi-Turn E-commerce Customer Service System

üåé[English](README.md) - [ÁÆÄ‰Ωì‰∏≠Êñá](README_CN.md) - [ÁπÅÈ´î‰∏≠Êñá](README_TW.md)

*All information below is generated by AI and is for reference only.*

An intelligent e-commerce customer service system based on FastAPI + Vue 3 + LangChain + Alibaba Cloud DashScope, supporting full-process multi-turn conversations for product inquiries, order processing, and after-sales rights protection.

## üåü Features

### ü§ñ Core AI Customer Service Functions
- **Multi-Turn Dialogue**: Supports complex multi-turn interactions based on the ReAct Agent model.
- **Context Understanding**: Automatically associates product information and order status.
- **Intelligent Decision Making**: Dynamically calls tools to address user needs.
- **Scalable**: Supports integration with various LLM models.

### üõçÔ∏è E-commerce Business Functions
- **Product Management**: Management of product lists, details, and specifications.
- **Order System**: Create orders, view order lists, and order details.
- **After-Sales Processing**: Request refunds and manage after-sales status.
- **Data Persistence**: MySQL database stores all business data.

### üé® Technical Features
- **Separation of Frontend and Backend**: FastAPI backend + Vue 3 frontend.
- **Responsive Design**: Supports access from various devices.
- **RESTful API**: Unified API interface design.
- **CORS Support**: Cross-Origin Resource Sharing configuration.

## üõ†Ô∏è Tech Stack

### Backend Tech Stack
| Technology/Framework | Version | Purpose |
|----------------------|---------|---------|
| FastAPI              | 0.115.0 | Web framework |
| Uvicorn              | 0.30.6  | ASGI server |
| Pydantic             | 2.6.1   | Data validation |
| PyMySQL              | -       | MySQL database connection |
| LangChain            | 0.1.0   | AI agent framework |
| DashScope            | 1.14.0  | Alibaba Cloud LLM API |
| numpy                | 1.26.4  | Numerical computation |

### Frontend Tech Stack
| Technology/Framework | Version | Purpose |
|----------------------|---------|---------|
| Vue 3                | 3.4.21  | Frontend framework |
| Vue Router           | 4.6.4   | Routing management |
| Axios                | 1.13.2  | HTTP requests |
| Vite                 | 5.2.0   | Build tool |

### Database
| Database | Version | Purpose |
|----------|---------|---------|
| MySQL    | 8.0+    | Business data storage |

## üì¶ Installation and Deployment

### 1. Environment Preparation

- Python 3.10+
- Node.js 16+
- MySQL 8.0+

### 2. Database Initialization

1. Create the database:```sql
CREATE DATABASE smart_mall CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci;
```

2. Import the database structure:
```bash
mysql -u username -p smart_mall < smart_mall.sql
```

### 3. Backend Deployment

1. Navigate to the backend directory:
```bash
cd backend
```

2. Create a virtual environment:
```bash
python -m venv venv
```

3. Activate the virtual environment:
```bash
# Windows
venv\Scripts\activate

# Linux/Mac
source venv/bin/activate
```

4. Install dependencies:
```bash
pip install -r requirements.txt
```

5. Configure environment variables (optional, default settings are in database.py):
```bash
export MYSQL_HOST=localhost
export MYSQL_PORT=3306
export MYSQL_USER=root
export MYSQL_PASSWORD=password
export MYSQL_DB=smart_mall
```

6. Start the backend service:
```bash
uvicorn api_server:app --reload --host 0.0.0.0 --port 8000
```

### 4. Frontend Deployment

1. Navigate to the frontend directory:
```bash
cd frontend
```

2. Install dependencies:
```bash
npm install
```

3. Start the development server:
```bash
npm run dev
```

4. Build a production version (optional):
```bash
npm run build
```

## üöÄ User Guide

### 1. Accessing the System

- Frontend: `http://localhost:5173`
- Backend API: `http://localhost:8000`
- API Documentation: `http://localhost:8000/docs`

### 2. AI Customer Service Chat

1. Visit the frontend page
2. Select a product or enter your order number (optional, for context)
3. Type your question, for example:
   - "What colors does this product come in?"
   - "When will my order be shipped?"
   - "I would like to request a refund"
4. The system will automatically process your request and provide a response

### 3. API Interface Call

Example: Calling the AI customer service interface

```bash
curl -X POST "http://localhost:8000/chat" \
  -H "Content-Type: application/json" \
  -d '{"message": "Ëøô‰∏™ÂïÜÂìÅÊúâ‰ªÄ‰πàÈ¢úËâ≤Ôºü", "product_id": "P12345678"}'
```

## üìñ API Documentation

### Health Check
- `GET /health` - Check service status

### AI Customer Service
- `POST /chat` - Send chat request

### Product Management
- `GET /api/products` - Retrieve product list
- `GET /api/products/{pid}` - Retrieve product details
- `POST /api/admin/products` - Create product
- `PUT /api/admin/products/{pid}` - Update product
- `DELETE /api/admin/products/{pid}` - Delete product

### Order Management
- `POST /api/orders` - Create order
- `GET /api/orders` - Retrieve order list
- `GET /api/orders/{order_no}` - Retrieve order details
- `POST /api/orders/{order_no}/refund` - Request refund
- `DELETE /api/orders/{order_no}` - Delete order

### Admin Interface
- `PATCH /api/admin/orders/{order_no}` - Update order status
- `DELETE /api/admin/orders/{order_no}` - Admin delete order

## üîß Configuration Instructions

### Backend Configuration

#### Database Configuration
Configure the database connection in `backend/database.py`:

```python
MYSQL_HOST = os.getenv("MYSQL_HOST", "127.0.0.1")
MYSQL_PORT = int(os.getenv("MYSQL_PORT", "3306"))
MYSQL_USER = os.getenv("MYSQL_USER", "root")
MYSQL_PASSWORD = os.getenv("MYSQL_PASSWORD", "password")
MYSQL_DB = os.getenv("MYSQL_DB", "smart_mall")
```

#### LLM Configuration
Configure the LLM in `backend/api_server.py`:

```python
DASHSCOPE_API_KEY = "your-api-key"
ALIYUN_MODEL_NAME = "qwen-turbo"
ALIYUN_TEMPERATURE = 0.2
```

### Frontend Configuration

Configure the API address in `frontend/src/api/backend.js`:

```javascript
const api = axios.create({
  baseURL: "http://127.0.0.1:8000",
  timeout: 10000
});
```

## üìä Database Structure

### Core Table Structure

#### products (Product Table)
- product_id: Product ID
- shop_id: Shop ID
- title: Product Title
- category: Product Category
- price: Product Price
- description: Product Description
- specs: Product Specifications
- image_url: Main Product Image
- carousel_images: Carousel Images
- detail_images: Detail Images

#### orders (Order Table)
- order_no: Order Number
- status: Order Status (PAID, SHIPPED, DELIVERED, REFUNDING, REFUNDED)
- receiver: Recipient
- phone_tail: Last Digits of Phone Number
- total_amount: Order Amount

#### order_items (Order Items Table)
- order_id: Order ID
- product_id: Product ID
- title: Product Title
- price: Product Price
- qty: Product Quantity

#### after_sales (After-Sales Table)
- after_sale_no: After-Sales Order Number
- order_no: Associated Order Number
- type: After-Sales Type
- reason: After-Sales Reason
- status: After-Sales Status

## üîç Core Functionality Implementation

### ReAct Agent Implementation

The system uses LangChain's ReAct Agent model to implement intelligent customer service, with core code located in `backend/agent/react_agent.py`:

1. Define tools: Product inquiry, order inquiry, etc.
2. Build Agent: Integrate LLM and tools
3. Execute dialogue: Process user input and generate responses

### Context Management

The system automatically handles contextual information:
- Product Context: Automatically loads product information when product_id is provided
- Order Context: Automatically loads order information when order_no is provided
- Conversation History: Maintains multi-turn conversation history

## ü§ù Contribution Guidelines

We welcome Issue and Pull Request submissions!

### Development Process

1. Fork the repository
2. Create a feature branch: `git checkout -b feature/AmazingFeature`
3. Commit changes: `git commit -m 'Add some AmazingFeature'`
4. Push to the branch: `git push origin feature/AmazingFeature`
5. Submit a Pull Request

## üìÑ License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## üìû Contact

If you have any questions or suggestions, please submit an Issue or contact the project maintainer.

---

**Star ‚≠ê this project if it has been helpful to you!**